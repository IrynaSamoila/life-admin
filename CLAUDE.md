# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a **static blog website** about life admin and personal organization, built with Next.js 15 (App Router), MDX, and Tailwind CSS. The site is optimized for static export and deployed to Vercel at https://life-admin.uk.

## Common Commands

```bash
# Development
npm run dev              # Start dev server at localhost:3000

# Building
npm run build            # Build for production (runs sitemap generation first)
npm run lint             # Run ESLint checks

# Testing production build locally
npm run build && npx serve@latest out
```

## Content Management

### Creating New Blog Posts

1. Create a new `.mdx` file in `content/posts/`
2. Use this frontmatter structure:

```mdx
---
title: Your Post Title
date: 2026-01-05                    # YYYY-MM-DD format
description: Brief post description  # For SEO and post cards
tags: [tag1, tag2, tag3]            # For categorization and related posts
---

Post content here...
```

**Required fields**: All frontmatter fields are required. Posts without complete frontmatter won't render properly.

**File naming**: Use kebab-case for filenames (e.g., `proof-of-address-uk.mdx`). The filename becomes the URL slug.

### Writing Style Guidelines

The blog has a distinctive conversational, practical tone:

- Avoid sounding "AI-generated" or overly formal
- Minimize excessive use of bullet lists—prefer natural paragraph flow
- Be direct and practical, not aspirational or motivational
- Use concrete examples and specific instructions
- Don't use emojis unless explicitly requested
- Focus on "what actually works" rather than ideal scenarios

Reference existing posts like `safe-place-important-things.mdx` or `password-management-simple.mdx` for tone examples.

## Architecture

### Content Processing Flow

1. **Post Discovery** (`lib/mdx.ts`):
   - `getAllPosts()` scans `content/posts/` for `.mdx` and `.md` files
   - Parses frontmatter with gray-matter
   - Calculates reading time with reading-time package
   - Sorts posts chronologically (newest first)
   - `getPostBySlug()` loads individual posts
   - `getRelatedPosts()` finds posts with shared tags

2. **Static Generation**:
   - `app/blog/[slug]/page.tsx` uses `generateStaticParams()` to pre-render all posts at build time
   - All pages are static HTML—no server-side rendering at runtime
   - Outputs to `/out/` directory for static hosting

3. **MDX Rendering** (`components/MDXContent.tsx`):
   - Uses `next-mdx-remote/rsc` for server-side MDX rendering
   - Custom components: `FileTree`, `DataTable`, `SimpleList`
   - All headings (h2, h3) automatically get slugified IDs for anchor links
   - Supports GitHub-flavored markdown via `remark-gfm`

4. **Search and Filtering** (`components/BlogSearch.tsx`):
   - Client-side search using fuse.js (fuzzy matching)
   - Tag-based filtering with URL synchronization
   - Search state managed via custom `useSearch` hook

### SEO Implementation

- **Metadata**: Configured in `lib/metadata.ts` (site name, URL, author, etc.)
- **Sitemap**: Auto-generated via `scripts/generate-sitemap.mjs` (runs on `prebuild`)
- **Robots.txt**: Generated by `app/robots.ts`
- **RSS Feed**: Generated at `/blog/rss.xml` (see `app/blog/rss.xml/route.ts`)
- **OpenGraph**: All pages include OpenGraph and Twitter card metadata

### Key Files to Know

- **`lib/mdx.ts`**: Post loading, parsing, and related post logic
- **`components/MDXContent.tsx`**: MDX component mapping and custom components
- **`lib/metadata.ts`**: SEO configuration and metadata helpers
- **`app/blog/[slug]/page.tsx`**: Dynamic blog post rendering
- **`components/BlogSearch.tsx`**: Search and tag filtering UI

## Adding Custom MDX Components

To add a new custom component for use in MDX posts:

1. Create the component in `components/`
2. Import it in `components/MDXContent.tsx`
3. Add to the `components` object:

```typescript
const components = {
  // ... existing components
  YourComponent,
};
```

4. Use in MDX posts like: `<YourComponent />`

## Configuration Files

- **`lib/metadata.ts`**: Site name, URL, author, email, social metadata
- **`next.config.ts`**: Next.js config (images unoptimized for static export, trailing slashes enabled)
- **`tailwind.config.ts`**: Typography plugin config, max prose width (~65ch for readability)
- **`scripts/generate-sitemap.mjs`**: Sitemap generation with SITE_URL constant

## Deployment

This site uses static export and is deployed to Vercel:

- Push to GitHub triggers automatic Vercel deployment
- No environment variables required
- Domain configured: life-admin.uk
- Static files output to `/out/` directory

## Notes

- **No server required**: This is a fully static site. All pages are pre-rendered at build time.
- **Reading time**: Automatically calculated for every post.
- **Table of contents**: Auto-generated from h2/h3 headings with active section highlighting.
- **Related posts**: Determined by shared tags (up to 3 posts).
- **Type safety**: Fully typed with TypeScript. Types defined in `lib/types.ts`.
